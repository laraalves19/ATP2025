#Aplicação para gestão de alunos
#aluno=(nome, id, [notaTPC, notaProj, notaTeste])
#turma=[aluno]

turma=[]
def menu():
    print("""
    (1)Criar uma turma
    (2)Inserir um aluno na turma
    (3)Listar a turma
    (4)Consultar um aluno por id
    (5)Guardar a turma em ficheiro
    (6)Carrega uma turma num ficheiro
    (0)Sair da aplicação
    """)

def criaTurma():
    turma=[]
    return turma


def inserirAluno(turma):
    n=int(input("Digite o número de alunos que a turma tem: "))
    i=0
    while i<n:
        nome=input("Introduza o nome do aluno: ")
        id=input("Introduza o id correspondente ao aluno: ")
        notaTPC=float(input("Introduza a nota do TPC do aluno: "))
        notaProj=float(input("Introduza a nota do projeto do aluno: "))
        notaTeste=float(input("Introduza a nota do teste do aluno:  "))
        aluno=(nome, id, [notaTPC, notaProj, notaTeste])
        turma.append(aluno)
        i=i+1
    return turma     

def listarTurma(turma):
    if len(turma)==0:
        print("A turma está vazia.")
    else:
        for aluno in turma:
            print(f"Nome:{aluno[0]}, ID:{aluno[1]}, Notas:{aluno[2]}")

def consultaID(turma):
    id=input("Introduza o ID do aluno: ")
    encontrado=False
    for aluno in turma:
        if id==aluno[1]:
            print(f"Aluno encontrado:{aluno}")
            encontrado=True
    if not encontrado:
        print("Não há nenhum aluno com este id.")

def guardarTurma(turma, fnome):
    fout=open("listaturma.txt", "wt")
    for aluno in turma:
        fout.write(f"{aluno[0]}; {aluno[1]}; {aluno[2][0]}; {aluno[2][1]};{aluno[2][2]}\n")

    fout.close()


def carregarTurma(fnome):
    turma_ficheiro=criaTurma()
    fin=open("listaturma.txt", "rt")
    for linha in fin: 
        elementos_linha=linha.strip().split(";")
        notas=[elementos_linha[2], elementos_linha[3], elementos_linha[4]]
        aluno=(elementos_linha[0], elementos_linha[1], notas)
        turma_ficheiro.append(aluno)
    return turma_ficheiro



cond=True
while cond==True:
    menu()
    acao=input("Introduza um número de 0 a 6 consoante a ação que pretende realizar, de acordo com o menu: ")
    
    try:
        opcao=int(acao)
    except ValueError:
        opcao=-1

    if opcao==1:
        criaTurma()
    elif opcao==2:
       inserirAluno(turma)
    elif opcao==3:
        listarTurma(turma)
    elif opcao==4:
        consultaID(turma)
    elif opcao==5:
        fnome=input("Nome do ficheiro: ")
        guardarTurma(turma,fnome)
        print("A sua turma foi guardada.")
    elif opcao==6:
        fnome=input("Nome do ficheiro: ")
        turma=carregarTurma(fnome)
    elif opcao==0:
        print("Saiu da aplicação. Esperamos ter ajudado.")
        cond=False
    else:
        print("Opção inválida. Escolha um número pertencente ao menu.")